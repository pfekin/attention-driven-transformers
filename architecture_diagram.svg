<?xml version="1.0" encoding="UTF-8"?>
<svg viewBox="0 0 1100 260" xmlns="http://www.w3.org/2000/svg" role="img" aria-label="Sparse-Layered Transformer architecture diagram">
  <defs>
    <style>
      .bg { fill: #ffffff; }
      .box { fill: #0f172a; stroke: none; fill-opacity:0.06; }
      .box-strong { fill: #0f172a; fill-opacity:0.10; stroke: #0f172a; stroke-opacity:0.12; stroke-width:1; }
      .accent { fill: #0ea5a4; } /* teal */
      .text { font-family: "Inter", "Helvetica Neue", Arial, sans-serif; fill: #0f172a; font-size:14px; }
      .title { font-size:16px; font-weight:700; }
      .subtitle { font-size:12px; fill: #334155; }
      .arrow { stroke: #0f172a; stroke-width:2; fill: none; marker-end: url(#arrowhead); marker-start: none; stroke-linecap:round; stroke-linejoin:round; opacity:0.9; }
      .small { font-size:12px; fill: #0f172a; }
      .chip { rx:10; ry:10; stroke: none; fill-opacity:0.06; }
      .box-label { font-size:13px; fill: #052039; font-weight:600; }
      .box-desc { font-size:12px; fill: #334155; }
    </style>
    <marker id="arrowhead" markerWidth="10" markerHeight="8" refX="10" refY="4" orient="auto">
      <path d="M0,0 L10,4 L0,8 z" fill="#0f172a" />
    </marker>
  </defs>

  <!-- background -->
  <rect class="bg" x="0" y="0" width="1100" height="260" />

  <!-- Title -->
  <text class="title" x="40" y="28">Sparse-Layered Transformer — architecture overview</text>
  <text class="subtitle" x="40" y="48">Projection blocks (linear + GELU) → Top attention (multi-head) → Flatten & head</text>

  <!-- Left group: Input / Patching -->
  <g transform="translate(40,72)">
    <rect x="0" y="0" width="140" height="48" rx="8" class="box-strong" />
    <text class="box-label" x="12" y="26">Input sequence</text>
    <text class="box-desc" x="12" y="42">batch × seq_len × vars</text>

    <path class="arrow" d="M160 24 L220 24" />

    <rect x="240" y="0" width="160" height="48" rx="8" class="box" />
    <text class="box-label" x="252" y="26">Patching</text>
    <text class="box-desc" x="252" y="42">overlapping windows → patches</text>

    <path class="arrow" d="M410 24 L470 24" />

    <rect x="490" y="0" width="180" height="48" rx="8" class="box" />
    <text class="box-label" x="502" y="26">Patch embedding</text>
    <text class="box-desc" x="502" y="42">Linear (patch_len → d_model)</text>
  </g>

  <!-- Middle group: Projection blocks -->
  <g transform="translate(40,150)">
    <!-- Projection block 1 -->
    <rect x="160" y="0" width="180" height="72" rx="12" class="chip" />
    <text class="box-label" x="178" y="28">Projection Block</text>
    <text class="box-desc" x="178" y="46">Linear (bias=False) → GELU → LayerNorm</text>
    <text class="small" x="178" y="62">FFN → LayerNorm</text>

    <path class="arrow" d="M340 36 L392 36" />

    <!-- Projection block 2 -->
    <rect x="400" y="0" width="180" height="72" rx="12" class="chip" />
    <text class="box-label" x="418" y="28">Projection Block</text>
    <text class="box-desc" x="418" y="46">Linear (bias=False) → GELU → LayerNorm</text>
    <text class="small" x="418" y="62">FFN → LayerNorm</text>

    <path class="arrow" d="M580 36 L632 36" />

    <!-- Top attention -->
    <rect x="650" y="-4" width="220" height="80" rx="12" class="box-strong" />
    <text class="box-label" x="668" y="24">Top Attention Block</text>
    <text class="box-desc" x="668" y="44">Multi-Head Self-Attention → LayerNorm → FFN</text>
    <text class="small" x="668" y="60">Global integrator (drives representation)</text>

    <path class="arrow" d="M870 36 L930 36" />
  </g>

  <!-- Right group: Flatten + Head -->
  <g transform="translate(40,220)">
    <rect x="960" y="12" width="120" height="48" rx="8" class="box" />
    <text class="box-label" x="972" y="34">Flatten & Head</text>
    <text class="box-desc" x="972" y="50">(num_patches×d_model → pred_len)</text>

    <!-- final note -->
    <text class="small" x="40" y="220">Complexity note: projection blocks are O(n); single attention block is O(n²) — fast and globally aware.</text>
  </g>

  <!-- decorative arrows from top path to flatten -->
  <path class="arrow" d="M920 36 L960 36" />

</svg>
